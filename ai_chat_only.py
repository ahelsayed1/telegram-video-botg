# ai_chat_only.py - ูุญุงุฏุซุฉ ุฐููุฉ ุจุณูุทุฉ ุฌุฏุงู (ุจุฏูู ุฃุฎุทุงุก)
import os
import logging
import random

logger = logging.getLogger(__name__)

class ChatManager:
    """ูุฏูุฑ ุงููุญุงุฏุซุฉ ุงูุจุณูุท"""
    
    def __init__(self, db):
        self.db = db
        logger.info("๐ค ูุฏูุฑ ุงููุญุงุฏุซุฉ ุฌุงูุฒ!")
    
    async def chat(self, user_id: int, message: str) -> str:
        """ูุญุงุฏุซุฉ ุฐููุฉ ูุน ุฑุฏูุฏ ุฐููุฉ"""
        try:
            message_lower = message.lower()
            
            # ุชุญููู ุงูุฑุณุงูุฉ ูุฅุฑุฌุงุน ุฑุฏ ููุงุณุจ
            if any(word in message_lower for word in ["ูุฑุญุจุง", "ุงููุง", "ุงูุณูุงู", "ููุง", "hello", "hi"]):
                responses = [
                    "ูุนูููู ุงูุณูุงู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู! ๐",
                    "ูุฑุญุจุงู ุจู! ๐ค ุณุนูุฏ ุจุฑุคูุชู.",
                    "ุฃููุงู ูุณููุงู! ๐ ููู ูููููู ูุณุงุนุฏุชูุ",
                    "ูุฑุญุจุงู! ๐ ุฃูุง ุงููุณุงุนุฏ ุงูุฐูู ููุจูุช.",
                ]
                return random.choice(responses)
            
            elif any(word in message_lower for word in ["ููู ุญุงูู", "ุดููู", "ุงุฎุจุงุฑู"]):
                return "ุงูุญูุฏ ููู ุจุฎูุฑ! ๐ ูุฃูุช ููู ุญุงููุ"
            
            elif any(word in message_lower for word in ["ุงุณูู", "ูู ุงูุช", "ูุง ุฃูุช"]):
                return "ุฃูุง ุงููุณุงุนุฏ ุงูุฐูู ูู ุจูุช ุชููุฌุฑุงู! ๐ค\nุชู ุชุทููุฑู ูุฃููู ุนููุงู ูู ูู ูุฎุชูู ุงููุฌุงูุงุช."
            
            elif any(word in message_lower for word in ["ุจูุช", "ุจุฑูุงูุฌ", "ุชุทุจูู"]):
                return "ูุนู! ูุฐุง ุจูุช ุชููุฌุฑุงู ูุชุทูุฑ ูุนูู ุนูู ููุตุฉ Railway.\nููููู ุงุณุชุฎุฏุงู ุงูุฃูุงูุฑ ุงููุฎุชููุฉ ููุชูุงุนู ูุนู."
            
            elif "ุ" in message or "?" in message:
                # ุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ
                question_responses = [
                    "ุณุคุงู ุฑุงุฆุน! ๐ค ุฏุนูู ุฃููุฑ ูู ุฃูุถู ุฅุฌุงุจุฉ...",
                    "ูุฐุง ููุถูุน ูุซูุฑ ููุงูุชูุงู! ๐ก",
                    "ุฃุญุชุงุฌ ุฅูู ูุฒูุฏ ูู ุงูุชูุงุตูู ููุฅุฌุงุจุฉ ุจุฏูุฉ.",
                    "ูููููู ูุณุงุนุฏุชู ูู ูุฐุงุ ููู ูู ููููู ุชูุถูุญ ุณุคุงูู ุฃูุซุฑุ",
                ]
                return random.choice(question_responses)
            
            elif any(word in message_lower for word in ["ุดูุฑุง", "ูุดููุฑ", "ุชุณูู", "thanks"]):
                return "ุงูุนูู! ๐ ุณุนูุฏ ูุฃููู ุงุณุชุทุนุช ุงููุณุงุนุฏุฉ.\nูู ุชุญุชุงุฌ ุฅูู ุฃู ุดูุก ุขุฎุฑุ"
            
            elif any(word in message_lower for word in ["ูุณุงุนุฏุฉ", "help", "ูุณุงุนุฏู", "ุงูุฃูุงูุฑ"]):
                return "ูููููู ูุณุงุนุฏุชู ูู:\n๐ฌ ุงููุญุงุฏุซุงุช ุงูุฐููุฉ\n๐ ุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงูุนุงูุฉ\n๐ก ุชูุฏูู ุงููุตุงุฆุญ\n\nุงุณุชุฎุฏู `/help` ูุฑุคูุฉ ุฌููุน ุฃูุงูุฑ ุงูุจูุช!"
            
            elif any(word in message_lower for word in ["ุญุจ", "ุญุจู", "ุงุญุจู"]):
                return "ุฃูุง ููุง ูุฃุฎุฏูู! โค๏ธ\nูููููู ูุณุงุนุฏุชู ูู ุงูุนุฏูุฏ ูู ุงูุฃููุฑ."
            
            elif len(message) < 3:
                return "ุฃุญุชุงุฌ ุฅูู ุฑุณุงูุฉ ุฃุทูู ููููุงู ูููู ูุง ุชูุตุฏู. ๐"
            
            else:
                # ุฑุฏูุฏ ุนุงูุฉ ุฐููุฉ
                general_responses = [
                    "ุฃููู ูุง ุชูุตุฏ! ๐ญ ูููููู ูุณุงุนุฏุชู ูู ุฐูู.",
                    "ูุฐุง ูุซูุฑ ููุงูุชูุงู! ๐",
                    "ุฑุงุฆุน! ุฏุนูู ุฃููุฑ ูู ููููุฉ ูุณุงุนุฏุชู...",
                    "ุดูุฑุงู ููุดุงุฑูุฉ ูุฐุง ูุนู. ๐ค",
                    "ุฃุณุชุทูุน ูุณุงุนุฏุชู ูู ูุฐุง ุงูุฃูุฑ. ูุง ุงูุฐู ุชุญุชุงุฌู ุจุงูุถุจุทุ",
                    "ูุฐุง ููุถูุน ููู! ๐ก",
                    "ูุฏู ุจุนุถ ุงูุฃููุงุฑ ุญูู ูุฐุง...",
                    "ุฏุนูู ุฃูุถุญ ูู ุจุนุถ ุงูููุงุท ุงููููุฉ.",
                    "ูุฐุง ุณุคุงู ุฌูุฏ! ุณุฃุญุงูู ุงูุฅุฌุงุจุฉ ุจุฃูุถู ูุง ูุฏู.",
                    "ููุชุงุฒ! ูุฐุง ููุชุญ ูุฌุงูุงู ููููุงุด.",
                ]
                return random.choice(general_responses)
                
        except Exception as e:
            logger.error(f"โ Chat error: {e}")
            return "ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน. ุญุงูู ูุฑุฉ ุฃุฎุฑู! ๐"
    
    def get_status(self):
        """ุญุงูุฉ ุงูุฎุฏูุฉ"""
        return {
            'chat_available': True,
            'status': 'โ ุฌุงูุฒ',
            'version': '1.0',
            'features': ['ูุญุงุฏุซุฉ ุฐููุฉ', 'ุฑุฏูุฏ ุฐููุฉ']
        }
    
    def get_user_stats(self, user_id: int):
        """ุฅุญุตุงุฆูุงุช ุงููุณุชุฎุฏู (ูุจุณุทุฉ)"""
        return {
            'chats_used': random.randint(1, 10),
            'daily_limit': 50,
            'chats_remaining': random.randint(30, 49),
            'status': 'โ ูุดุท'
        }
